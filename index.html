<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What's My Info</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.3);
            --text-primary: #1a1a1a;
            --text-secondary: #666;
            --text-label: #999;
            --accent: #0078d4;
            --success: #107c10;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --glass-bg: rgba(30, 30, 30, 0.85);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --text-label: #777;
            --accent: #60cdff;
            --success: #6ccb5f;
            --shadow: rgba(0, 0, 0, 0.5);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Desktop only styles */
        @media (min-width: 769px) {
            /* Map background */
            #map-background {
                position: fixed;
                top: -10%;
                left: -10%;
                width: 120%;
                height: 120%;
                z-index: 1;
                border: none;
                pointer-events: auto;
                transition: filter 0.3s;
                transform: scale(1.15);
                object-fit: cover;
            }


            [data-theme="dark"] #map-background {
                filter: invert(0.9) hue-rotate(180deg) brightness(0.9) contrast(1.1);
            }
          
            [data-theme="dark"] #map-overlay {
                background: rgba(0, 0, 0, 0.5);
            }

            /* Glass card */
            .card {
                background: var(--glass-bg);
                backdrop-filter: blur(20px) saturate(180%);
                border: 1px solid var(--glass-border);
                border-radius: 16px;
                padding: 40px;
                box-shadow: 0 8px 32px var(--shadow);
            }

            /* Top controls */
            .top-controls {
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 6;
                display: flex;
                gap: 12px;
            }

            .control-btn {
                width: 48px;
                height: 48px;
                border-radius: 50%;
                border: 1px solid var(--glass-border);
                background: var(--glass-bg);
                backdrop-filter: blur(20px);
                color: var(--text-primary);
                font-size: 20px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.2s;
                box-shadow: 0 4px 12px var(--shadow);
            }

            .control-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 16px var(--shadow);
            }

            .info-btn-special {
                width: auto;
                padding: 0 20px;
                border-radius: 24px;
                gap: 8px;
                background: var(--accent);
                color: white;
                font-weight: 600;
                font-size: 14px;
            }

            .info-btn-special:hover {
                background: var(--accent-hover);
            }
          
            .info-toggle {
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 4;
                padding: 14px 28px;
                border-radius: 30px;
                border: 1px solid var(--glass-border);
                background: var(--glass-bg);
                backdrop-filter: blur(20px);
                color: var(--text-primary);
                font-size: 16px;
                font-weight: 500;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                transition: all 0.2s;
                box-shadow: 0 4px 16px var(--shadow);
            }

            .info-toggle:hover {
                transform: translateX(-50%) translateY(-2px);
                box-shadow: 0 6px 20px var(--shadow);
            }
          
            /* Map drawer */
            #info-drawer {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0.8);
                z-index: 5;
                width: 90%;
                max-width: 800px;
                max-height: 85vh;
                background: var(--glass-bg);
                backdrop-filter: blur(20px);
                border: 1px solid var(--glass-border);
                border-radius: 16px;
                box-shadow: 0 8px 32px var(--shadow);
                padding: 40px;
                overflow-y: auto;
                opacity: 0;
                pointer-events: none;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            #info-drawer.open {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
                pointer-events: auto;
            }

            #info-drawer-close {
                position: absolute;
                top: 20px;
                right: 20px;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                border: 1px solid var(--glass-border);
                background: var(--glass-bg);
                color: var(--text-primary);
                font-size: 24px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.2s;
            }

            #info-drawer-close:hover {
                background: var(--accent);
                color: white;
            }
          
            #info-backdrop {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.4);
                z-index: 4;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s;
            }

            #info-backdrop.open {
                opacity: 1;
                pointer-events: auto;
            }
          
            #refresh-btn {
                transition: transform 0.5s ease;
            }

            #refresh-btn:active {
                transform: rotate(180deg);
            }
          
          
            .map-toggle:hover {
                transform: translateX(-50%) translateY(-2px);
                box-shadow: 0 6px 20px var(--shadow);
            }

            /* Header */
            .header {
                text-align: center;
                margin-bottom: 32px;
            }

            .header-title {
                font-size: 14px;
                color: var(--text-label);
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ip-display {
                font-size: 48px;
                font-weight: 700;
                color: var(--text-primary);
                margin-bottom: 4px;
                cursor: pointer;
                transition: color 0.2s;
            }

            .ip-display:hover {
                color: var(--accent);
            }

            .ip-badge {
                display: inline-block;
                padding: 4px 12px;
                background: rgba(255, 59, 48, 0.1);
                color: #ff3b30;
                border: 1px solid rgba(255, 59, 48, 0.3);
                border-radius: 12px;
                font-size: 12px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            /* Info sections */
            .info-section {
                margin-bottom: 32px;
            }

            .info-section:last-child {
                margin-bottom: 0;
            }

            .section-title {
                font-size: 12px;
                color: var(--text-label);
                text-transform: uppercase;
                letter-spacing: 1px;
                margin-bottom: 12px;
            }

            .info-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }

            .info-grid-3 {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 20px;
            }

            .info-item {
                cursor: pointer;
                transition: all 0.2s;
                padding: 4px;
                border-radius: 6px;
            }

            .info-item:hover {
                background: rgba(0, 120, 212, 0.05);
            }

            .info-item.copied {
                background: rgba(16, 124, 16, 0.1);
            }

            .info-label {
                font-size: 13px;
                color: var(--text-label);
                margin-bottom: 4px;
            }

            .info-value {
                font-size: 16px;
                font-weight: 600;
                color: var(--text-primary);
            }

            .divider {
                height: 0.1px;
                background: rgba(0, 0, 0, 0.1);
                margin: 32px 0;
            }

            /* Toast */
            .toast {
                position: fixed;
                bottom: 80px;
                left: 50%;
                transform: translateX(-50%) translateY(100px);
                background: var(--success);
                color: white;
                padding: 12px 24px;
                border-radius: 30px;
                font-size: 14px;
                font-weight: 500;
                z-index: 6;
                opacity: 0;
                transition: all 0.3s;
                box-shadow: 0 4px 16px var(--shadow);
            }

            .toast.show {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Mobile styles */
        @media (max-width: 768px) {
            body {
                background: var(--text-primary);
                padding: 20px;
                overflow-y: auto;
                height: auto;
            }

            .mobile-placeholder {
                color: var(--text-secondary);
                text-align: center;
                padding: 60px 20px;
            }

            .mobile-placeholder h1 {
                font-size: 24px;
                margin-bottom: 16px;
            }

            .mobile-placeholder p {
                font-size: 16px;
                line-height: 1.6;
            }

            /* Hide desktop elements on mobile */
            #map-background,
            #map-overlay,
            .container,
            .top-controls,
            .map-toggle,
            #map-drawer,
            .toast {
                display: none !important;
            }
        }
    </style>
</head>
<body data-theme="light">
    <!-- Desktop version -->
    <iframe id="map-background" loading="lazy"></iframe>

    <div id="map-overlay"></div>
  
    <div class="top-controls">
        <button class="control-btn info-btn-special" id="info-toggle" title="View Details">üì° Details</button>
        <button class="control-btn" id="refresh-btn" title="Refresh Data">üîÑ</button>
        <button class="control-btn" id="export-btn" title="Export JSON">üì•</button>
        <button class="control-btn" id="theme-toggle" title="Toggle theme">üåô</button>
    </div>

    <div id="info-backdrop"></div>
    <div id="info-drawer">
        <button id="info-drawer-close">√ó</button>
                    <div class="header">
                        <div class="header-title">Your Public IP Address</div>
                        <div class="ip-display" id="ipv4-display" title="Click to copy">Loading...</div>
                    </div>
      
                    <div class="divider"></div>
      
                    <div class="info-section">
                        <div class="section-title">Network Details</div>
                        <div class="info-grid-3">
                            <div class="info-item" data-value="isp">
                                <div class="info-label">ISP</div>
                                <div class="info-value" id="isp">Loading...</div>
                            </div>
                            <div class="info-item" data-value="ipv6">
                                <div class="info-label">IPv6 Address</div>
                                <div class="info-value" id="ipv6">Loading...</div>
                            </div>
                            <div class="info-item" data-value="asn">
                                <div class="info-label">ASN</div>
                                <div class="info-value" id="asn">Loading...</div>
                            </div>
                            <div class="info-item" data-value="timezone">
                                <div class="info-label">Timezone</div>
                                <div class="info-value" id="timezone">Loading...</div>
                            </div>
                            <div class="info-item" data-value="connection-type">
                                <div class="info-label">Connection type</div>
                                <div class="info-value" id="network-type">üì° Loading...</div>
                            </div>
                            <div class="info-item" data-value="location">
                                <div class="info-label">Location</div>
                                <div class="info-value" id="location">üìç Loading...</div>
                            </div>
                         
                        </div>
                    </div>

                    <div class="divider"></div>

                    <div class="info-section">
                        <div class="section-title">Device Information</div>
                        <div class="info-grid-3">
                            <div class="info-item" data-value="device">
                                <div class="info-label">Device type</div>
                                <div class="info-value" id="device">Loading...</div>
                            </div>
                            <div class="info-item" data-value="os">
                                <div class="info-label">Operating system</div>
                                <div class="info-value" id="os">Loading...</div>
                            </div>
                            <div class="info-item" data-value="screen">
                                <div class="info-label">Screen resolution</div>
                                <div class="info-value" id="screen">Loading...</div>
                            </div>
                        </div>
                    </div>

                    <div class="divider"></div>

                    <div class="info-section">
                        <div class="info-grid-3">
                            <div class="info-item" data-value="browser">
                                <div class="info-label">Browser</div>
                                <div class="info-value" id="browser">Loading...</div>
                            </div>
                            <div class="info-item" data-value="language">
                                <div class="info-label">Language</div>
                                <div class="info-value" id="language">Loading...</div>
                            </div>
                            <div class="info-item" data-value="pixel-ratio">
                                <div class="info-label">Pixel ratio</div>
                                <div class="info-value" id="pixel-ratio">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
    </div>

    <button class="map-toggle" id="map-toggle">üó∫ View Full Map</button>

    <div id="map-drawer">
        <button id="map-drawer-close">√ó</button>
        <iframe id="map-interactive" loading="lazy"></iframe>
    </div>

    <div class="toast" id="toast">‚úì Copied to clipboard</div>

    <!-- Mobile placeholder -->
    <div class="mobile-placeholder">
        <h1>üì± Mobile Version</h1>
        <p>The mobile-optimized version is coming soon. For now, please use a desktop browser to access all features.</p>
    </div>

    <script>
        const appData = {};

        // Theme handling
        function getPreferredTheme() {
            const saved = localStorage.getItem('theme');
            if (saved) return saved;
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        const body = document.body;
        
        const initialTheme = getPreferredTheme();
        body.setAttribute('data-theme', initialTheme);
        if (themeToggle) themeToggle.textContent = initialTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                const current = body.getAttribute('data-theme');
                const newTheme = current === 'light' ? 'dark' : 'light';
                body.setAttribute('data-theme', newTheme);
                themeToggle.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                localStorage.setItem('theme', newTheme);
            });
        }

        // Toast notification
        function showToast() {
            const toast = document.getElementById('toast');
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // Copy to clipboard
        async function copyToClipboard(text, element) {
            try {
                await navigator.clipboard.writeText(text);
                element.classList.add('copied');
                showToast();
                setTimeout(() => element.classList.remove('copied'), 2000);
            } catch (err) {
                console.error('Copy failed:', err);
            }
        }

        // Click to copy functionality
        document.querySelectorAll('.info-item').forEach(item => {
            item.addEventListener('click', () => {
                const valueEl = item.querySelector('.info-value');
                const text = valueEl.textContent.replace(/^[üì°üìç]\s*/, ''); // Remove emoji prefix
                copyToClipboard(text, item);
            });
        });

        // IP display click to copy
        const ipDisplay = document.getElementById('ipv4-display');
        if (ipDisplay) {
            ipDisplay.addEventListener('click', () => {
                copyToClipboard(ipDisplay.textContent, ipDisplay);
            });
        }

        // Map drawer
        const infoToggle = document.getElementById('info-toggle');
        const infoDrawer = document.getElementById('info-drawer');
        const infoDrawerClose = document.getElementById('info-drawer-close');
        const infoBackdrop = document.getElementById('info-backdrop');

        if (infoToggle && infoDrawer && infoDrawerClose && infoBackdrop) {
            infoToggle.addEventListener('click', () => {
                infoDrawer.classList.add('open');
                infoBackdrop.classList.add('open');
            });

            infoDrawerClose.addEventListener('click', () => {
                infoDrawer.classList.remove('open');
                infoBackdrop.classList.remove('open');
            });

            infoBackdrop.addEventListener('click', () => {
                infoDrawer.classList.remove('open');
                infoBackdrop.classList.remove('open');
            });
        }

        // Export JSON
        const exportBtn = document.getElementById('export-btn');
        if (exportBtn) {
            exportBtn.addEventListener('click', () => {
                const dataStr = JSON.stringify(appData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `my-info-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
            });
        }
        
        const refreshBtn = document.getElementById('refresh-btn');
        if (refreshBtn) {
            refreshBtn.addEventListener('click', async () => {
                // Add spinning animation
                refreshBtn.style.transform = 'rotate(360deg)';
                refreshBtn.style.transition = 'transform 0.5s';

                // Refresh all data
                await init();

                // Reset animation
                setTimeout(() => {
                    refreshBtn.style.transform = 'rotate(0deg)';
                }, 500);
            });
        }
      
        // Detect OS
        function detectOS() {
            const ua = navigator.userAgent;
            if (ua.includes('Win')) return 'Windows';
            if (ua.includes('Mac')) return 'macOS';
            if (ua.includes('Linux')) return 'Linux';
            if (ua.includes('Android')) return 'Android';
            if (ua.includes('iOS')) return 'iOS';
            return 'Unknown';
        }

        // Detect browser
        function detectBrowser() {
            const ua = navigator.userAgent;
            if (ua.includes('Firefox')) return 'Firefox';
            if (ua.includes('Edg')) return 'Edge';
            if (ua.includes('Chrome')) return 'Chrome';
            if (ua.includes('Safari') && !ua.includes('Chrome')) return 'Safari';
            return 'Unknown';
        }

        // Detect device type
        function detectDevice() {
            const ua = navigator.userAgent;
            if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) return 'Tablet';
            if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)) return 'Mobile';
            return 'PC';
        }

        // Populate system info
        function populateSystemInfo() {
            const os = detectOS();
            const browser = detectBrowser();
            const device = detectDevice();
            const screen = `${window.screen.width}√ó${window.screen.height}`;
            const language = navigator.language;
            const pixelRatio = window.devicePixelRatio;
            const networkType = navigator.connection?.effectiveType || 'Unknown';
            
            document.getElementById('os').textContent = os;
            document.getElementById('browser').textContent = browser;
            document.getElementById('device').textContent = device;
            document.getElementById('screen').textContent = screen;
            document.getElementById('language').textContent = language;
            document.getElementById('pixel-ratio').textContent = pixelRatio;
            document.getElementById('network-type').textContent = `üì° ${networkType}`;
            
            appData.os = os;
            appData.browser = browser;
            appData.device = device;
            appData.screen = screen;
            appData.language = language;
            appData.pixelRatio = pixelRatio;
            appData.networkType = networkType;
        }

        // Fetch IPv4
        async function fetchIPv4() {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                document.getElementById('ipv4-display').textContent = data.ip;
                appData.ipv4 = data.ip;
                return data.ip;
            } catch (err) {
                document.getElementById('ipv4-display').textContent = 'Unavailable';
                console.error('IPv4 fetch error:', err);
            }
        }

        // Fetch IPv6
        async function fetchIPv6() {
            try {
                const res = await fetch('https://api64.ipify.org?format=json');
                const data = await res.json();
                const ipv6 = data.ip.includes(':') ? data.ip : 'Not available';
                document.getElementById('ipv6').textContent = ipv6;
                appData.ipv6 = ipv6;
            } catch (err) {
                document.getElementById('ipv6').textContent = 'Unavailable';
                console.error('IPv6 fetch error:', err);
            }
        }

        // Fetch IP metadata
        async function fetchIPMetadata() {
            try {
                const res = await fetch('https://ipwho.is/');
                const data = await res.json();
                
                if (data.success) {
                    const location = `üìç ${data.city}, ${data.country}`;
                    document.getElementById('location').textContent = location;
                    document.getElementById('isp').textContent = data.connection?.org || 'Unknown';
                    document.getElementById('asn').textContent = data.connection?.asn || 'Unknown';
                    document.getElementById('timezone').textContent = data.timezone?.id || 'Unknown';
                    
                    appData.city = data.city;
                    appData.region = data.region;
                    appData.country = data.country;
                    appData.countryCode = data.country_code;
                    appData.latitude = data.latitude;
                    appData.longitude = data.longitude;
                    appData.isp = data.connection?.org;
                    appData.asn = data.connection?.asn;
                    appData.timezone = data.timezone?.id;
                    
                    // Update maps
                    const mapUrl = `https://www.google.com/maps?q=${data.latitude},${data.longitude}&output=embed&z=13`;
                    document.getElementById('map-background').src = mapUrl;
                }
            } catch (err) {
                console.error('Metadata fetch error:', err);
            }
        }

        // Initialize
        async function init() {
            populateSystemInfo();
            await Promise.all([
                fetchIPv4(),
                fetchIPv6(),
                fetchIPMetadata()
            ]);
          
            // Show info drawer on first load
            if (infoDrawer && infoBackdrop) {
                infoDrawer.classList.add('open');
                infoBackdrop.classList.add('open');
            }
        }

        // Only initialize on desktop
        if (window.innerWidth > 768) {
            init();
        }
    </script>
</body>
</html>
